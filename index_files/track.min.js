var rh_track=function(e,t,i){var n,r={debug:!1,logType:1,logContainer:"body",host:"http://track.wannengye.com",contextPath:function(){return this.host+""},ccinitPath:"/statics/ccinit.html",ccsetPath:"/statics/ccset.html",url_ip_geo:"/api/getIpAndGeo",randomSize:1e16,timingDelay:1e4,eventTimeDelay:5e3,authId:0,pageId:0,keywordCount:5,initData:{browser:!1,geo:!1,trackId:!1,isSelf:0}},o={cookie_browser:"ana_c_browser",cookie_geo:"ana_c_geo",cookie_keywords:"and_c_keywords",cookie_track_id:"ana_c_track_id_v3",cookie_visitor_id:"ana_c_uid_v3",cookie_visitor_session:"ana_c_session_v3",cookie_visitor_new:"ana_c_new",cookie_visitor_uv:"ana_c_uv",cookie_referrer_first:"ana_c_first",class_event:"_rha_event"},a={path:"/"},s=(function(){var e=jQuery.event.special,t="D"+ +new Date;e.scrollstop={latency:300,setup:function(){var i,n=function(t){var n=this,r=arguments;i&&clearTimeout(i),i=setTimeout(function(){i=null,t.type="scrollstop",jQuery.event.dispatch.apply(n,r)},e.scrollstop.latency)};jQuery(this).bind("scroll",n).data(t,n)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(t))}}}(),function(){function t(e){for(var t,i=0;i<e.length;i++){t=e[i];var n=t.string,r=t.prop;if(this.versionSearchString=t.versionSearch||t.identity,n){if(-1!=n.indexOf(t.subString))return t.identity}else if(r)return t.identity}}function i(e){var t=e.indexOf(versionSearchString);if(-1!=t)return parseFloat(e.substring(t+versionSearchString.length+1))}function n(){var e={browser:t(r)||"an unknown browser",version:i(navigator.userAgent)||i(navigator.appVersion)||"an unknown version",os:t(a)||"an unknown OS",ua:navigator.userAgent};return u.setCCookie(o.cookie_browser,e,{json:!0,expires:365,escape:!0})}var r=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:e.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],a=[{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];return{init:n}}()),c=function(){function i(){return t.when(n(),a()).done(function(){u.setCCookie(o.cookie_geo,c,{json:!0,expires:3}).done(function(){s.resolve(c)})}),s.promise()}function n(){var e=t.Deferred();return t.getJSON(r.host+r.url_ip_geo).done(function(i){t.extend(c,i),e.resolve()}).fail(function(){e.resolve()}),e.promise()}function a(){var i=t.Deferred();if(r.getGeo&&e.navigator.geolocation){var n={enableHighAccuracy:!0};e.navigator.geolocation.getCurrentPosition(function(e){t.extend(c,{lat:e.coords.latitude,lon:e.coords.longitude}),i.resolve()},function(){i.resolve()},n)}else i.resolve();return i.promise()}var s=t.Deferred(),c={lon:0,lat:0,ip:"",country:"",province:"",city:""};return{init:i}}(),u=function(){function e(e,t,i){return e=t?JSON.stringify(e):e,i?escape(JSON.stringify(e)):encodeURIComponent(e)}function n(e,t){return t?unescape(JSON.stringify(e)):decodeURIComponent(e)}function o(i,n,o){var s=t.Deferred();o=t.extend({},a,o);var u=[i,"=",e(n,o.json,o.escape),o.expires?";expires="+c(o.expires):""].join("");return g.buildIframe(r.ccsetPath+"#"+u).on("load",function(){s.resolve()}),s.promise()}function s(r,o,s){if(s=t.extend({},a,s),o!==i){var u=[r,"=",e(o,s.json,s.escape),s.expires?";expires="+c(s.expires):"",s.path?";path="+s.path:"",s.domain?";domain="+s.domain:"",s.secure?";secure":""].join("");return document.cookie=u}for(var d=r?i:{},g=document.cookie?document.cookie.split("; "):[],v=0,l=g.length;v<l;v++){var p=g[v].split("="),f=p.shift(),h=p.join("=");if(r&&r===f){d=n(h,s.escape);break}r||h===i||(d[f]=h)}return d}function c(e){var i=new Date;if(t.isNumeric(e)&&e>0)return i.setDate(i.getDate()+e),i.toGMTString();var n=i.toGMTString().split(" ");return n[4]="23:59:59",n.join(" ")}function u(e){return s(e)!==i&&(s(e,"",{expires:-1}),!s(e))}return{setCCookie:o,cookie:s,remove:u}}(),d=function(){function e(e){return r=u.cookie(o.cookie_visitor_id),i=u.cookie(o.cookie_visitor_new),a=u.cookie(o.cookie_visitor_session),n=u.cookie(o.cookie_visitor_uv),r&&!a&&(s=1),r||""===r||(r=g.random(),u.cookie(o.cookie_visitor_id,r,{expires:365})),a||""===a||(a=g.random(),u.cookie(o.cookie_visitor_session,a)),i=i?0:1,n=n?0:1,u.cookie(o.cookie_visitor_new,i,{expires:365}),u.cookie(o.cookie_visitor_uv,n,{expires:0}),{visitorId:r,isNew:i,sessionId:a,isUv:n,isReturn:s,viewCompletion:g.getViewCompletion()}}function t(){var e=g.random();return u.setCCookie(o.cookie_track_id,e,{expires:365})}var i,n,r,a,s=0;return{init:e,buildTrackId:t}}(),g={log:function(){r.debug&&(r.logType===i||r.logType>0?console.log.apply(console,arguments):t(r.logContainer).append("<p>"+JSON.stringify(arguments[0])+"</p>"))},random:function(e){e=e||r.randomSize;var t=(new Date).getTime()+Math.floor(100*Math.random());t=(9301*t+49297)%233280,t/=233280;var i=r.authId;return i<0&&(i=-i),Math.ceil(t*e)+""+i},getParameter:function(e){if(0===location.search.length)return"";var i,n=location.search.substring(1).split("&"),r="";return t.each(n,function(t,n){return""!==n&&(i=n.split("="),i[0]===e?(r=decodeURIComponent(i[1]),!1):void 0)}),r},referrerType:{href:1,search:2,weixin:3,weibo:4,qr:5,mp:5,email:6},getReferrer:function(e){var t={searchName:"",keyword:"",host:"",referrer:"",type:0,isSelf:r.initData.isSelf},i=this.getParameter("wny_source");if(""!==i)return t.type=this.referrerType[i],t.searchName=i,t.keyword=this.getParameter("wny_name"),t;var n=navigator.userAgent.toLowerCase();if(-1!==n.indexOf("micromessenger"))return t.type=this.referrerType.weixin,t.searchName="weixin",t;if(-1!==n.indexOf("weibo"))return t.type=this.referrerType.weibo,t.searchName="weibo",t;if(!r.debug&&u.cookie(o.cookie_referrer_first))return t;u.cookie(o.cookie_referrer_first,1);var a=e||document.referrer;if(!a||""===a)return t;t.type=this.referrerType.href,t.host=a.split("/")[2],t.referrer=a;var s,c,d,g=a.split(".")[1];switch(g){case"baidu":s=/wd\=.*\&?/i;break;case"google":s=/q\=.*\&?/i;break;case"sogou":case"soso":s=/query\=.*\&?/i;break;case"bing":s=/q\=.*\&?/i;break;case"yahoo":s=/p\=.*\&?/i;break;case"so":s=/q\=.*\&?/i}return(c=a.match(s)+"")&&""!==c&&"null"!==c?(t.type=this.referrerType.search,d=c.split("=")[1].split("&")[0],t.searchName=g,t.keyword=decodeURIComponent(d),t):t},getKeywords:function(){var e=t("meta[name='keywords']").prop("content");if(!e)return"";var i=e.split(",");return i.length>r.keywordCount&&(e=i.slice(0,r.keywordCount).join(",")),e},getPage:function(){var e=location.pathname;e.indexOf(";jsessionid")>-1&&(e=e.substring(0,e.indexOf(";jsessionid"))),e&&""!==e&&(a.path=e),e.lastIndexOf("/")===e.length-1&&(e=e.slice(0,e.length-1));var t=e.split("/"),i=t.length,n=t[i-1];t.splice(i-1,1);var r=t.join("/"),o=location.href;return o.indexOf(";jsessionid")>-1&&(o=o.substring(0,o.indexOf(";jsessionid"))),a.domain=location.host.split(":")[0],{title:document.title,href:o,protocol:location.protocol,host:location.host,path:r,pageName:"/"+n,search:location.search,hash:location.hash,keywords:this.getKeywords()}},getViewCompletion:function(){this.windowHeight=this.windowHeight||document.body.clientHeight;var i=t(e).height()+t(document).scrollTop();return parseInt(100*(i/this.windowHeight).toFixed(1))},buildIframe:function(e){var i=(new Date).getTime();return t("<iframe/>",{id:"dyIframe_"+i,src:r.contextPath()+e,style:"display:none;"}).appendTo("body").on("load",function(){t(this).remove()})}},v=function(){};return t.extend(v.prototype,{postType:{visit:"/visit",timing:"/timing",event:"/event",viewing:"/viewing",geo:"/geo"},postData:function(e,t){if(r.debug)return void g.log(e,t);var i=i||new Image;i.src=r.contextPath()+e+"/track.png?t="+(new Date).getTime()+"&"+t},initBaseParms:function(e){return t.extend(r,e),!(!r.authId||r.authId<1)&&(this.authId=r.authId,this.pageId=r.pageId||0,!0)},saveVisitData:function(){var e=this;e.page=g.getPage(),e.referrer=g.getReferrer(),t.extend(e,d.init(e)),g.log(e),e.postData(e.postType.visit,"data="+encodeURIComponent(JSON.stringify(e)))},saveEventData:function(e){var t=this;if(e&&""!==e){var i=(new Date).getTime(),n=t.events=t.events||{},o=n[e];o||(n[e]=o={name:e,count:0}),(!o.time||i-o.time>r.eventTimeDelay)&&(o.count+=1,t.postData(t.postType.event,"sessionId="+t.sessionId+"&data="+encodeURIComponent(JSON.stringify(o)))),o.time=i}},startTiming:function(e){if(!r.debug){var t=this;setInterval(function(){var e=1;document.visibilityState&&(e="visible"===document.visibilityState?1:0),t.postData(t.postType.timing,"data="+t.sessionId+"&v="+e)},r.timingDelay)}},startObservEvent:function(){var e=this;t("body").on("click","."+o.class_event,function(i){var n=t(i.currentTarget).data("event-name");e.saveEventData(n)})},startObservScroll:function(){var e=cvc=g.getViewCompletion(),i=this;t(document).bind("scrollstop",function(t){t.preventDefault();var n=g.getViewCompletion();n>e&&(e=n,i.postData(i.postType.viewing,"sessionId="+i.sessionId+"&vc="+n))})},startTracking:function(i){var n=this;if(n.initBaseParms(i)){var o=function(){n.saveVisitData(),n.startTiming(),n.startObservEvent(),n.startObservScroll()};g.buildIframe(r.ccinitPath+"#"+location.origin+location.pathname+"&"+document.referrer),t(e).on("message",function(e){var i=e.originalEvent;i.origin===r.host&&(t.extend(r.initData,i.data),!r.debug&&i.data.browser&&i.data.geo&&i.data.trackId?o():t.when(s.init(),c.init(),d.buildTrackId()).done(function(){o()}),t(this).off("message"))})}}}),{init:function(e){n=n||new v,n.startTracking(e)},triggerEvent:function(e){n&&n.saveEventData(e)}}}(window,jQuery);